{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/jackmay/learning-dev/graphql-app/jackstagram/client/lib/secureRoute.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport nextCookie from 'next-cookies';\nimport Login from '../components/auth/Login';\nimport { Query } from 'react-apollo';\nimport { SINGLE_USER_QUERY } from '../lib/query';\n\nvar secureRoute = function secureRoute(Component) {\n  var Wrapper =\n  /*#__PURE__*/\n  function (_React$Component) {\n    _inherits(Wrapper, _React$Component);\n\n    function Wrapper() {\n      _classCallCheck(this, Wrapper);\n\n      return _possibleConstructorReturn(this, _getPrototypeOf(Wrapper).apply(this, arguments));\n    }\n\n    _createClass(Wrapper, [{\n      key: \"render\",\n      value: function render() {\n        if (!this.props.token) return __jsx(Login, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 9\n          },\n          __self: this\n        });\n        return __jsx(Query, {\n          query: SINGLE_USER_QUERY,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 11\n          },\n          __self: this\n        }, function (data, error) {\n          console.log(data, error);\n          if (error) return __jsx(Login, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 14\n            },\n            __self: this\n          });\n          return __jsx(Component, _extends({}, data, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 15\n            },\n            __self: this\n          }));\n        });\n      }\n    }]);\n\n    return Wrapper;\n  }(React.Component);\n\n  Wrapper.getInitialProps =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(ctx) {\n      var _nextCookie, token;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _nextCookie = nextCookie(ctx), token = _nextCookie.token;\n              return _context.abrupt(\"return\", {\n                token: token\n              });\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return Wrapper;\n};\n\nexport default secureRoute;","map":{"version":3,"sources":["/Users/jackmay/learning-dev/graphql-app/jackstagram/client/lib/secureRoute.js"],"names":["nextCookie","Login","Query","SINGLE_USER_QUERY","secureRoute","Component","Wrapper","props","token","data","error","console","log","React","getInitialProps","ctx"],"mappings":";;;;;;;;;;;AAAA,OAAOA,UAAP,MAAuB,cAAvB;AACA,OAAOC,KAAP,MAAkB,0BAAlB;AACA,SAASC,KAAT,QAAsB,cAAtB;AACA,SAASC,iBAAT,QAAkC,cAAlC;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,SAAD,EAAe;AAAA,MAC3BC,OAD2B;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,+BAEtB;AACP,YAAI,CAAC,KAAKC,KAAL,CAAWC,KAAhB,EAAuB,OAAO,MAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACvB,eACE,MAAC,KAAD;AAAO,UAAA,KAAK,EAAEL,iBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACG,UAACM,IAAD,EAAOC,KAAP,EAAiB;AAChBC,UAAAA,OAAO,CAACC,GAAR,CAAYH,IAAZ,EAAkBC,KAAlB;AACA,cAAIA,KAAJ,EAAW,OAAO,MAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAP;AACX,iBAAO,MAAC,SAAD,eAAeD,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAP;AACD,SALH,CADF;AASD;AAb8B;;AAAA;AAAA,IACXI,KAAK,CAACR,SADK;;AAgBjCC,EAAAA,OAAO,CAACQ,eAAR;AAAA;AAAA;AAAA;AAAA;AAAA,6BAA0B,iBAAOC,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,4BACNf,UAAU,CAACe,GAAD,CADJ,EAChBP,KADgB,eAChBA,KADgB;AAAA,+CAEjB;AAAEA,gBAAAA,KAAK,EAALA;AAAF,eAFiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA1B;;AAAA;AAAA;AAAA;AAAA;;AAKA,SAAOF,OAAP;AACD,CAtBD;;AAwBA,eAAeF,WAAf","sourcesContent":["import nextCookie from 'next-cookies'\nimport Login from '../components/auth/Login'\nimport { Query } from 'react-apollo'\nimport { SINGLE_USER_QUERY } from '../lib/query'\n \nconst secureRoute = (Component) => {\n  class Wrapper extends React.Component {\n    render() {\n      if (!this.props.token) return <Login />\n      return (\n        <Query query={SINGLE_USER_QUERY}>\n          {(data, error) => {\n            console.log(data, error)\n            if (error) return <Login />\n            return <Component {...data}/>\n          }}\n        </Query>\n      )\n    }\n  }\n\n  Wrapper.getInitialProps = async (ctx) => {\n    const { token } = nextCookie(ctx)\n    return { token }\n  }\n  \n  return Wrapper\n}\n\nexport default secureRoute"]},"metadata":{},"sourceType":"module"}